summary(treatment.noNA.anos)
plot(treatment.noNA.anos)
siteANDtreatment.noNA.anos <- anosim(sdms.noNA.vegdist, grouping=data4anosim.noNA$BOTH, permutations = 2000)
siteANDtreatment.noNA.anos
summary(siteANDtreatment.noNA.anos)
plot(siteANDtreatment.noNA.anos)
data4anosim.log <- cbind.data.frame(SRM.data.mean.t.log[order(rownames(SRM.data.mean.t.log)),], samples4anosim[order(samples4anosim$SAMPLE),])
sdms.log.vegdist <- vegdist(data4anosim.log[,-(ncol(data4anosim)-3):-(ncol(data4anosim))], 'bray', na.rm=TRUE)
site.log.anos<-anosim(sdms.log.vegdist, grouping=data4anosim.log$SITE, permutations = 2000)
summary(site.log.anos)
plot(site.log.anos)
treatment.log.anos<-anosim(sdms.log.vegdist, grouping=data4anosim.log$TREATMENT, permutations = 2000)
summary(treatment.log.anos)
plot(treatment.log.anos)
siteANDtreatment.log.anos <- anosim(sdms.log.vegdist, grouping=data4anosim.log$BOTH, permutations = 2000)
summary(siteANDtreatment.log.anos)
plot(siteANDtreatment.log.anos)
library(reshape2)
data.melted <- melt(data4anosim.noNA, id=c("SAMPLE", "SITE", "TREATMENT", "BOTH"), variable.name = "Transition", value.name = "Area")
SRM.proteins <- data.frame(SRM.data.screened.noPRTC[,1:4]) #protein name to each transition
SRM.proteins[,1] <- sub(" cds.*", "", SRM.proteins[,1])
data.melted.plus <- merge(x=data.melted, y=SRM.proteins, by.x = "Transition", by.y = "row.names", all.x=TRUE, all.y=FALSE)
colnames(data.melted.plus)[1] <- "Pep.Trans"
# Script #4 in data processing for NOT NORMALIZED DATA
######## Run ANOSIM for each protein separately. Requires reshape2() library
# Prepare data for anosim by protein, isolating the melted & annotated area data
Arachidonate <- data.melted.plus[grepl(c("Arachidonate"), data.melted.plus$Protein.Name),]
Catalase <- data.melted.plus[grepl(c("Catalase"), data.melted.plus$Protein.Name),]
Cytochrome <- data.melted.plus[grepl(c("Cytochrome"), data.melted.plus$Protein.Name),]
Glycogen <- data.melted.plus[grepl(c("Glycogen"), data.melted.plus$Protein.Name),]
HSP70 <- data.melted.plus[grepl(c("Heat shock 70"), data.melted.plus$Protein.Name),]
HSP90 <- data.melted.plus[grepl(c("HSP 90"), data.melted.plus$Protein.Name),]
Peroxiredoxin <- data.melted.plus[grepl(c("Peroxiredoxin"), data.melted.plus$Protein.Name),]
PDI <- data.melted.plus[grepl(c("Protein disulfide-isomerase"), data.melted.plus$Protein.Name),]
Puromycin <- data.melted.plus[grepl(c("Puromycin"), data.melted.plus$Protein.Name),]
Rab.11B <- data.melted.plus[grepl(c("Rab-11B"), data.melted.plus$Protein.Name),]
NAK <- data.melted.plus[grepl(c("Sodium/potassium"), data.melted.plus$Protein.Name),]
Superoxide <- data.melted.plus[grepl(c("Superoxide"), data.melted.plus$Protein.Name),]
Trifunctional <- data.melted.plus[grepl(c("Trifunctional"), data.melted.plus$Protein.Name),]
# Convert data to long form by casting it, making first column row names
Arachidonate.4anosim <- data.frame(merge(dcast(Arachidonate[,c(1,2,3,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE", all.y = TRUE), row.names = 1)
Catalase.4anosim <- data.frame(merge(dcast(Catalase[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Cytochrome.4anosim <- data.frame(merge(dcast(Cytochrome[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Glycogen.4anosim <- data.frame(merge(dcast(Glycogen[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
HSP70.4anosim <- data.frame(merge(dcast(HSP70[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
HSP90.4anosim <- data.frame(merge(dcast(HSP90[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Peroxiredoxin.4anosim <- data.frame(merge(dcast(Peroxiredoxin[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
PDI.4anosim <- data.frame(merge(dcast(PDI[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Puromycin.4anosim <- data.frame(merge(dcast(Puromycin[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Rab.11B.4anosim <- data.frame(merge(dcast(Rab.11B[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
NAK.4anosim <- data.frame(merge(dcast(NAK[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Superoxide.4anosim <- data.frame(merge(dcast(Superoxide[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Trifunctional.4anosim <- data.frame(merge(dcast(Trifunctional[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
# P=0.42129
Arachidonate.vegdist <- vegdist(Arachidonate.4anosim[,1:9], 'bray', na.rm=TRUE)
Arachidonate.ANOSIM <-anosim(Arachidonate.vegdist, Arachidonate.4anosim$SITE, permutations = 2000)
summary(Arachidonate.ANOSIM)
# png("Analyses/2017-September_SRM-results/2017-09-04_NotNORM-plot-ANOSIM%03d.png")
plot(Arachidonate.ANOSIM)
# P=0.74863
Catalase.vegdist <- vegdist(Catalase.4anosim[,1:9], 'bray', na.rm=TRUE)
Catalase.ANOSIM <-anosim(Catalase.vegdist, grouping=Catalase.4anosim$SITE, permutations = 2000)
summary(Catalase.ANOSIM)
# png("Analyses/2017-September_SRM-results/2017-09-04_NotNORM-plot-ANOSIM%03d.png")
plot(Catalase.ANOSIM)
# dev.off()
Catalase.vegdist <- vegdist(Catalase.4anosim[,1:9], 'bray', na.rm=TRUE)
Catalase.4anosim <- data.frame(merge(dcast(Catalase[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Catalase.vegdist <- vegdist(Catalase.4anosim[,1:9], 'bray', na.rm=TRUE)
Catalase <- data.melted.plus[grepl(c("Catalase"), data.melted.plus$Protein.Name),]
Catalase.4anosim <- data.frame(merge(dcast(Catalase[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Catalase.vegdist <- vegdist(Catalase.4anosim[,1:9], 'bray', na.rm=TRUE)
HSP70.vegdist <- vegdist(HSP70.4anosim[,1:6], 'bray', na.rm=TRUE)
HSP70 <- data.melted.plus[grepl(c("Heat shock 70"), data.melted.plus$Protein.Name),]
HSP70.4anosim <- data.frame(merge(dcast(HSP70[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Arachidonate <- data.melted.plus[grepl(c("Arachidonate"), data.melted.plus$Protein.Name),]
Arachidonate <- data.melted.plus[grepl(c("Arachidonate"), data.melted.plus$Protein.Name),]
View(Arachidonate)
View(Catalase)
Arachidonate <- data.melted.plus[grepl(c("Arachidonate"), data.melted.plus$Protein.Name),]
Catalase <- data.melted.plus[grepl(c("Catalase"), data.melted.plus$Protein.Name),]
Cytochrome <- data.melted.plus[grepl(c("Cytochrome"), data.melted.plus$Protein.Name),]
Glycogen <- data.melted.plus[grepl(c("Glycogen"), data.melted.plus$Protein.Name),]
HSP70 <- data.melted.plus[grepl(c("Heat shock 70"), data.melted.plus$Protein.Name),]
HSP90 <- data.melted.plus[grepl(c("HSP 90"), data.melted.plus$Protein.Name),]
Peroxiredoxin <- data.melted.plus[grepl(c("Peroxiredoxin"), data.melted.plus$Protein.Name),]
PDI <- data.melted.plus[grepl(c("Protein disulfide-isomerase"), data.melted.plus$Protein.Name),]
Puromycin <- data.melted.plus[grepl(c("Puromycin"), data.melted.plus$Protein.Name),]
Rab.11B <- data.melted.plus[grepl(c("Rab-11B"), data.melted.plus$Protein.Name),]
NAK <- data.melted.plus[grepl(c("Sodium/potassium"), data.melted.plus$Protein.Name),]
Superoxide <- data.melted.plus[grepl(c("Superoxide"), data.melted.plus$Protein.Name),]
Trifunctional <- data.melted.plus[grepl(c("Trifunctional"), data.melted.plus$Protein.Name),]
View(data.melted.plus)
View(data4anosim)
View(SRM.data)
Arachidonate <- data.melted.plus[grepl(c("Arachidonate"), data.melted.plus$Protein.Name),]
Catalase <- data.melted.plus[grepl(c("Catalase"), data.melted.plus$Protein.Name),]
Cytochrome <- data.melted.plus[grepl(c("Cytochrome"), data.melted.plus$Protein.Name),]
Glycogen <- data.melted.plus[grepl(c("Glycogen"), data.melted.plus$Protein.Name),]
HSP70 <- data.melted.plus[grepl(c("HSP70"), data.melted.plus$Protein.Name),]
HSP90 <- data.melted.plus[grepl(c("HSP90-alpha"), data.melted.plus$Protein.Name),]
Peroxiredoxin <- data.melted.plus[grepl(c("Peroxiredoxin"), data.melted.plus$Protein.Name),]
PDI <- data.melted.plus[grepl(c("PDI"), data.melted.plus$Protein.Name),]
Puromycin <- data.melted.plus[grepl(c("Puromycin-sensitive"), data.melted.plus$Protein.Name),]
Rab.11B <- data.melted.plus[grepl(c("Ras-related"), data.melted.plus$Protein.Name),]
NAK <- data.melted.plus[grepl(c("Sodium/potassium-transporting"), data.melted.plus$Protein.Name),]
Superoxide <- data.melted.plus[grepl(c("Superoxide"), data.melted.plus$Protein.Name),]
Trifunctional <- data.melted.plus[grepl(c("Trifunctional"), data.melted.plus$Protein.Name),]
View(HSP70)
Arachidonate.4anosim <- data.frame(merge(dcast(Arachidonate[,c(1,2,3,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE", all.y = TRUE), row.names = 1)
Catalase.4anosim <- data.frame(merge(dcast(Catalase[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Cytochrome.4anosim <- data.frame(merge(dcast(Cytochrome[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Glycogen.4anosim <- data.frame(merge(dcast(Glycogen[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
HSP70.4anosim <- data.frame(merge(dcast(HSP70[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
HSP90.4anosim <- data.frame(merge(dcast(HSP90[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Peroxiredoxin.4anosim <- data.frame(merge(dcast(Peroxiredoxin[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
PDI.4anosim <- data.frame(merge(dcast(PDI[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Puromycin.4anosim <- data.frame(merge(dcast(Puromycin[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Rab.11B.4anosim <- data.frame(merge(dcast(Rab.11B[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
NAK.4anosim <- data.frame(merge(dcast(NAK[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Superoxide.4anosim <- data.frame(merge(dcast(Superoxide[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Trifunctional.4anosim <- data.frame(merge(dcast(Trifunctional[,c(1,2,6)], SAMPLE~Pep.Trans), samples4anosim, by.x="SAMPLE", by.y="SAMPLE"), row.names = 1)
Arachidonate.vegdist <- vegdist(Arachidonate.4anosim[,1:9], 'bray', na.rm=TRUE)
Arachidonate.ANOSIM <-anosim(Arachidonate.vegdist, Arachidonate.4anosim$SITE, permutations = 2000)
summary(Arachidonate.ANOSIM)
plot(Arachidonate.ANOSIM)
Catalase.vegdist <- vegdist(Catalase.4anosim[,1:9], 'bray', na.rm=TRUE)
Catalase.ANOSIM <-anosim(Catalase.vegdist, grouping=Catalase.4anosim$SITE, permutations = 2000)
View(Catalase)
View(Catalase.4anosim)
View(Catalase.4anosim[1,])
Catalase.4anosim[1,]
View(Catalase.4anosim)
Catalase.vegdist <- vegdist(Catalase.4anosim[,1:6], 'bray', na.rm=TRUE)
Catalase.ANOSIM <-anosim(Catalase.vegdist, grouping=Catalase.4anosim$SITE, permutations = 2000)
summary(Catalase.ANOSIM)
plot(Catalase.ANOSIM)
Cytochrome.vegdist <- vegdist(Cytochrome.4anosim[,1:9], 'bray', na.rm=TRUE)
Cytochrome.ANOSIM <-anosim(Cytochrome.vegdist, grouping=Cytochrome.4anosim$SITE, permutations = 2000)
summary(Cytochrome.ANOSIM)
plot(Cytochrome.ANOSIM)
Glycogen.vegdist <- vegdist(Glycogen.4anosim[,1:9], 'bray', na.rm=TRUE)
Glycogen.ANOSIM <-anosim(Glycogen.vegdist, grouping=Glycogen.4anosim$SITE, permutations = 2000)
summary(Glycogen.ANOSIM)
plot(Glycogen.ANOSIM)
HSP70.vegdist <- vegdist(HSP70.4anosim[,1:6], 'bray', na.rm=TRUE)
HSP70.ANOSIM <-anosim(HSP70.vegdist, grouping=HSP70.4anosim$SITE, permutations = 2000)
summary(HSP70.ANOSIM)
plot(HSP70.ANOSIM)
HSP90.vegdist <- vegdist(HSP90.4anosim[,1:9], 'bray', na.rm=TRUE)
HSP90.ANOSIM <-anosim(HSP90.vegdist, grouping=HSP90.4anosim$SITE, permutations = 2000)
summary(HSP90.ANOSIM)
plot(HSP90.ANOSIM)
Peroxiredoxin.vegdist <- vegdist(Peroxiredoxin.4anosim[,1:3], 'bray', na.rm=TRUE)
Peroxiredoxin.ANOSIM <-anosim(Peroxiredoxin.vegdist, grouping=Peroxiredoxin.4anosim$SITE, permutations = 2000)
summary(Peroxiredoxin.ANOSIM)
plot(Peroxiredoxin.ANOSIM)
PDI.vegdist <- vegdist(PDI.4anosim[,1:6], 'bray', na.rm=TRUE)
PDI.ANOSIM <-anosim(PDI.vegdist, grouping=PDI.4anosim$SITE, permutations = 2000)
summary(PDI.ANOSIM)
plot(PDI.ANOSIM)
Puromycin.vegdist <- vegdist(Puromycin.4anosim[,1:9], 'bray', na.rm=TRUE)
Puromycin.ANOSIM <-anosim(Puromycin.vegdist, grouping=Puromycin.4anosim$SITE, permutations = 2000)
summary(Puromycin.ANOSIM)
plot(PDI.ANOSIM)
plot(Puromycin.ANOSIM)
Rab.11B.vegdist <- vegdist(Rab.11B.4anosim[,1:3], 'bray', na.rm=TRUE)
Rab.11B.ANOSIM <-anosim(Rab.11B.vegdist, grouping=Rab.11B.4anosim$SITE, permutations = 2000)
summary(Rab.11B.ANOSIM)
plot(Rab.11B.ANOSIM)
NAK.vegdist <- vegdist(NAK.4anosim[,1:6], 'bray', na.rm=TRUE)
NAK.ANOSIM <-anosim(NAK.vegdist, grouping=NAK.4anosim$SITE, permutations = 2000)
summary(NAK.ANOSIM)
plot(NAK.ANOSIM)
Superoxide.vegdist <- vegdist(Superoxide.4anosim[,1:5], 'bray', na.rm=TRUE)
Superoxide.ANOSIM <-anosim(Superoxide.vegdist, grouping=Superoxide.4anosim$SITE, permutations = 2000)
summary(Superoxide.ANOSIM)
plot(Superoxide.ANOSIM)
View(Trifunctional.4anosim)
Trifunctional.vegdist <- vegdist(Trifunctional.4anosim[,1:9], 'bray', na.rm=TRUE)
Trifunctional.ANOSIM <-anosim(Trifunctional.vegdist, grouping=Trifunctional.4anosim$SITE, permutations = 2000)
summary(Trifunctional.ANOSIM)
plot(Trifunctional.ANOSIM)
library(ggplot2)
levels(data.melted.plus$SITE)
data.melted.plus$SITE <- factor(data.melted.plus$SITE, levels=c("WB", "CI", "PG", "FB"))
ggplot(subset(data.melted.plus, Pep.Trans %in% "GVVDSEDLPLNISR y7"), aes(x=SITE, y=Area, fill=SITE)) +
geom_boxplot(color="black", position = position_dodge()) +
ggtitle("Heat shock 90 \nabundance by site") +
theme(plot.title = element_text(size=22), axis.text=element_text(size=12), axis.title=element_text(size=14,face="bold"), axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank()) +
guides(fill=FALSE) +
scale_fill_discrete(labels=c("Willapa Bay", "Case Inlet", "Fidalgo Bay", "Port Gamble")) +
ylab("Protein Abundance (Peak Intensity)") +
coord_flip()
ggplot(subset(data.melted.plus, Pep.Trans %in% "IINEPTAAALAYGLDK y12"), aes(x=SITE, y=Area, fill=SITE)) +
geom_boxplot(color="black", position = position_dodge()) +
ggtitle("Heat shock 70 \nabundance by site") +
theme(plot.title = element_text(size=22), axis.text=element_text(size=12), axis.title=element_text(size=14,face="bold"), axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank()) +
guides(fill=FALSE) +
scale_fill_discrete(labels=c("Willapa Bay", "Case Inlet", "Fidalgo Bay", "Port Gamble")) +
ylab("Protein Abundance (Peak Intensity)") +
coord_flip()
ggplot(subset(data.melted.plus, Pep.Trans %in% "DNVVVIGFFK y5"), aes(x=SITE, y=Area, fill=SITE)) +
geom_boxplot(color="black", position = position_dodge()) +
ggtitle("Protein Disulfide Isomerase \nabundance by site") +
theme(plot.title = element_text(size=22), axis.text=element_text(size=12), axis.title=element_text(size=14,face="bold"), axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank()) +
guides(fill=FALSE) +
scale_fill_discrete(labels=c("Willapa Bay", "Case Inlet", "Fidalgo Bay", "Port Gamble")) +
ylab("Protein Abundance (Peak Intensity)") +
coord_flip()
par(mfrow = c(3, 2), mar=c(1,1,2,01), oma=c(1,2,3,1), cex.main= 1.3, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
setwd("~/Documents/Roberts Lab/O.lurida_Stress/Data")
Histo <- read.csv("2017-Oly-Histo-Results.csv", header=T, stringsAsFactors = T)
Histo$Stage <- as.factor(Histo$Stage)
library(plyr)
# All Populations Combined ------------------------------------------------
All.6 <- subset(Histo, Phase %in% "TEMP" & Treatment %in% "6")
All.10 <- subset(Histo, Phase %in% "TEMP" & Treatment %in% "10")
All.6.Low <- subset(Histo, Phase %in% "OA" & Treatment %in% "6-Low")
All.6.Amb <- subset(Histo, Phase %in% "OA" & Treatment %in% "6-Amb")
All.10.Low <- subset(Histo, Phase %in% "OA" & Treatment %in% "10-Low")
All.10.Amb <- subset(Histo, Phase %in% "OA" & Treatment %in% "10-Amb")
Allp.6 <- data.frame(unclass(100*prop.table(table(All.6$Stage))))
Allp.10 <- data.frame(unclass(100*prop.table(table(All.10$Stage))))
Allp.6.Low <- data.frame(unclass(100*prop.table(table(All.6.Low$Stage))))
Allp.6.Amb <- data.frame(unclass(100*prop.table(table(All.6.Amb$Stage))))
Allp.10.Low <- data.frame(unclass(100*prop.table(table(All.10.Low$Stage))))
Allp.10.Amb <- data.frame(unclass(100*prop.table(table(All.10.Amb$Stage))))
All.p <- data.frame(cbind(Allp.6, Allp.10, Allp.6.Low, Allp.6.Amb, Allp.10.Low, Allp.10.Amb))
colnames(All.p) <- c("6", "10", "6.Low", "6.Amb", "10.Low", "10.Amb")
Stages <- c("Stage 1", "Stage 2", "Stage 3")
par(mfrow = c(3, 2), mar=c(1,1,2,01), oma=c(1,2,3,1), cex.main= 1.3, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
pie(table(All.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Amb$Stage), "\n", round(All.p$`6.Amb`), "%", sep=""))
pie(table(All.10.Amb$Stage), main="10 DegC, Amp pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Amb$Stage), "\n", round(All.p$`10.Amb`), "%", sep=""))
title("Gonad Stage by Treatment, all Populations \nOstrea lurida 2016-2017 Experiment", outer=TRUE)
par(mfrow = c(3, 2), mar=c(1.5,1,2,1.5), oma=c(1,2,3,1), cex.main= 1.3, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
pie(table(All.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Amb$Stage), "\n", round(All.p$`6.Amb`), "%", sep=""))
pie(table(All.10.Amb$Stage), main="10 DegC, Amp pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Amb$Stage), "\n", round(All.p$`10.Amb`), "%", sep=""))
title("Gonad Stage by Treatment, all Populations \nOstrea lurida 2016-2017 Experiment", outer=TRUE)
par(mfrow = c(3, 2), mar=c(1.5,1,2,1.5), oma=c(1.5,2,3,1.5), cex.main= 1.3, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
pie(table(All.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Amb$Stage), "\n", round(All.p$`6.Amb`), "%", sep=""))
pie(table(All.10.Amb$Stage), main="10 DegC, Amp pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Amb$Stage), "\n", round(All.p$`10.Amb`), "%", sep=""))
title("Gonad Stage by Treatment, all Populations \nOstrea lurida 2016-2017 Experiment", outer=TRUE)
dev.off()
par(mfrow = c(3, 2), mar=c(1.5,1,2,2), oma=c(1.5,2,3,2), cex.main= 1.3, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
par(mfrow = c(3, 2), mar=c(1.5,1,2,1.5), oma=c(1.5,2,3,1.5), cex.main= 1, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
pie(table(All.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Amb$Stage), "\n", round(All.p$`6.Amb`), "%", sep=""))
pie(table(All.10.Amb$Stage), main="10 DegC, Amp pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Amb$Stage), "\n", round(All.p$`10.Amb`), "%", sep=""))
par(mfrow = c(3, 2), mar=c(1.5,1,3,.5), oma=c(1.5,2,3,1.5), cex.main= 1, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
pie(table(All.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Amb$Stage), "\n", round(All.p$`6.Amb`), "%", sep=""))
pie(table(All.10.Amb$Stage), main="10 DegC, Amp pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Amb$Stage), "\n", round(All.p$`10.Amb`), "%", sep=""))
par(mfrow = c(3, 2), mar=c(.5,1,3.5,.5), oma=c(1.5,2,3,1.5), cex.main= 1, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
pie(table(All.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Amb$Stage), "\n", round(All.p$`6.Amb`), "%", sep=""))
pie(table(All.10.Amb$Stage), main="10 DegC, Amp pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Amb$Stage), "\n", round(All.p$`10.Amb`), "%", sep=""))
par(mfrow = c(3, 2), mar=c(.5,1,3.5,.5), oma=c(1,2,3,1), cex.main= 1, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
pie(table(All.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Amb$Stage), "\n", round(All.p$`6.Amb`), "%", sep=""))
pie(table(All.10.Amb$Stage), main="10 DegC, Amp pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Amb$Stage), "\n", round(All.p$`10.Amb`), "%", sep=""))
title("Gonad Stage by Treatment, all Populations \nOstrea lurida 2016-2017 Experiment", outer=TRUE)
setwd("~/Documents/Roberts Lab/O.lurida_Stress/Data")
Histo <- read.csv("2017-Oly-Histo-Results.csv", header=T, stringsAsFactors = T)
Histo$Stage <- as.factor(Histo$Stage)
library(plyr)
# All Populations Combined ------------------------------------------------
All.6 <- subset(Histo, Phase %in% "TEMP" & Treatment %in% "6")
All.10 <- subset(Histo, Phase %in% "TEMP" & Treatment %in% "10")
All.6.Low <- subset(Histo, Phase %in% "OA" & Treatment %in% "6-Low")
All.6.Amb <- subset(Histo, Phase %in% "OA" & Treatment %in% "6-Amb")
All.10.Low <- subset(Histo, Phase %in% "OA" & Treatment %in% "10-Low")
All.10.Amb <- subset(Histo, Phase %in% "OA" & Treatment %in% "10-Amb")
Allp.6 <- data.frame(unclass(100*prop.table(table(All.6$Stage))))
Allp.10 <- data.frame(unclass(100*prop.table(table(All.10$Stage))))
Allp.6.Low <- data.frame(unclass(100*prop.table(table(All.6.Low$Stage))))
Allp.6.Amb <- data.frame(unclass(100*prop.table(table(All.6.Amb$Stage))))
Allp.10.Low <- data.frame(unclass(100*prop.table(table(All.10.Low$Stage))))
Allp.10.Amb <- data.frame(unclass(100*prop.table(table(All.10.Amb$Stage))))
All.p <- data.frame(cbind(Allp.6, Allp.10, Allp.6.Low, Allp.6.Amb, Allp.10.Low, Allp.10.Amb))
colnames(All.p) <- c("6", "10", "6.Low", "6.Amb", "10.Low", "10.Amb")
Stages <- c("Stage 1", "Stage 2", "Stage 3")
png(filename = "~/Documents/Roberts Lab/O.lurida_Stress/Analyses/Gonad-Stage-Pie-Charts.png", width = 600, height = 800)
par(mfrow = c(3, 2), mar=c(.5,1,3.5,.5), oma=c(1,2,3,1), cex.main= 1, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
pie(table(All.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Amb$Stage), "\n", round(All.p$`6.Amb`), "%", sep=""))
pie(table(All.10.Amb$Stage), main="10 DegC, Amp pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Amb$Stage), "\n", round(All.p$`10.Amb`), "%", sep=""))
title("Gonad Stage by Treatment, all Populations \nOstrea lurida 2016-2017 Experiment", outer=TRUE)
dev.off()
# Each Population Separately ----------------------------------------------
Pops <- levels(Histo$Population)
Pop.names <- c("Hood Canal", "South Sound F2", "Fidalgo Bay", "South Sound F1")
for (i in 1:length(Pops)) {
T <- Pops[i]
T.6 <- subset(Histo, Population %in% T & Phase %in% "TEMP" & Treatment %in% "6")
T.10 <- subset(Histo, Population %in% T & Phase %in% "TEMP" & Treatment %in% "10")
T.6.Low <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "6-Low")
T.6.Amb <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "6-Amb")
T.10.Low <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "10-Low")
T.10.Amb <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "10-Amb")
Tp.6 <- data.frame(unclass(100*prop.table(table(T.6$Stage))))
Tp.10 <- data.frame(unclass(100*prop.table(table(T.10$Stage))))
Tp.6.Low <- data.frame(unclass(100*prop.table(table(T.6.Low$Stage))))
Tp.6.Amb <- data.frame(unclass(100*prop.table(table(T.6.Amb$Stage))))
Tp.10.Low <- data.frame(unclass(100*prop.table(table(T.10.Low$Stage))))
Tp.10.Amb <- data.frame(unclass(100*prop.table(table(T.10.Amb$Stage))))
T.p <- data.frame(cbind(Tp.6, Tp.10, Tp.6.Low, Tp.6.Amb, Tp.10.Low, Tp.10.Amb))
colnames(T.p) <- c("6", "10", "6.Low", "6.Amb", "10.Low", "10.Amb")
Stages <- c("Stage 1", "Stage 2", "Stage 3")
filename <- paste("~/Documents/Roberts Lab/O.lurida_Stress/Analyses/Gonad-Stage-Pie-Charts-", T, ".png", sep="")
png(filename = filename, width = 600, height = 800)
par(mfrow = c(3, 2), mar=c(.5,1,3.5,.5), oma=c(1,2,3,1), cex.main= 1, cex=.75)
pie(table(T.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(T.6$Stage), "\n", round(T.p$`6`), "%", sep=""))
pie(table(T.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(T.10$Stage), ", ", round(T.p$`10`), "%", sep=""))
pie(table(T.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.6.Low$Stage), "\n", round(T.p$`6.Low`), "%", sep=""))
pie(table(T.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.10.Low$Stage), "\n", round(T.p$`10.Low`), "%", sep=""))
pie(table(T.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.6.Amb$Stage), "\n", round(T.p$`6.Amb`), "%", sep=""))
pie(table(T.10.Amb$Stage), main="10 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.10.Amb$Stage), "\n", round(T.p$`10.Amb`), "%", sep=""))
title(paste("Gonad Stage by Treatment ", Pop.names[i], "\n", "Ostrea lurida 2016-2017 Experiment", sep=""), outer=TRUE)
dev.off()
}
### boneyard
# Histo$Stage <- as.factor(Histo$Stage)
# counts.temp <- count(df=subset(Histo, Phase %in% "TEMP"), c("Phase", "Treatment", "Stage"))
# counts.OA <- count(df=subset(Histo, Phase %in% "OA"), c("Phase", "Treatment", "Stage"))
# counts.all <- count(df=Histo, c("Phase", "Treatment", "Stage"))
par(mfrow = c(3, 2), mar=c(.5,1,3.5,.5), oma=c(1,2,3,1), cex.main= 1.5, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
pie(table(All.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Amb$Stage), "\n", round(All.p$`6.Amb`), "%", sep=""))
pie(table(All.10.Amb$Stage), main="10 DegC, Amp pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Amb$Stage), "\n", round(All.p$`10.Amb`), "%", sep=""))
par(mfrow = c(3, 2), mar=c(.5,1,3.5,.5), oma=c(1,2,3,1), cex.main= 1.4, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
par(mfrow = c(3, 2), mar=c(.5,1,3.5,.5), oma=c(1,2,3,1), cex.main= 1.3, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
setwd("~/Documents/Roberts Lab/O.lurida_Stress/Data")
Histo <- read.csv("2017-Oly-Histo-Results.csv", header=T, stringsAsFactors = T)
Histo$Stage <- as.factor(Histo$Stage)
library(plyr)
# All Populations Combined ------------------------------------------------
All.6 <- subset(Histo, Phase %in% "TEMP" & Treatment %in% "6")
All.10 <- subset(Histo, Phase %in% "TEMP" & Treatment %in% "10")
All.6.Low <- subset(Histo, Phase %in% "OA" & Treatment %in% "6-Low")
All.6.Amb <- subset(Histo, Phase %in% "OA" & Treatment %in% "6-Amb")
All.10.Low <- subset(Histo, Phase %in% "OA" & Treatment %in% "10-Low")
All.10.Amb <- subset(Histo, Phase %in% "OA" & Treatment %in% "10-Amb")
Allp.6 <- data.frame(unclass(100*prop.table(table(All.6$Stage))))
Allp.10 <- data.frame(unclass(100*prop.table(table(All.10$Stage))))
Allp.6.Low <- data.frame(unclass(100*prop.table(table(All.6.Low$Stage))))
Allp.6.Amb <- data.frame(unclass(100*prop.table(table(All.6.Amb$Stage))))
Allp.10.Low <- data.frame(unclass(100*prop.table(table(All.10.Low$Stage))))
Allp.10.Amb <- data.frame(unclass(100*prop.table(table(All.10.Amb$Stage))))
All.p <- data.frame(cbind(Allp.6, Allp.10, Allp.6.Low, Allp.6.Amb, Allp.10.Low, Allp.10.Amb))
colnames(All.p) <- c("6", "10", "6.Low", "6.Amb", "10.Low", "10.Amb")
Stages <- c("Stage 1", "Stage 2", "Stage 3")
png(filename = "~/Documents/Roberts Lab/O.lurida_Stress/Analyses/Gonad-Stage-Pie-Charts.png", width = 600, height = 800)
par(mfrow = c(3, 2), mar=c(.5,1,3.5,.5), oma=c(1,2,3,1), cex.main= 1.3, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
pie(table(All.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Amb$Stage), "\n", round(All.p$`6.Amb`), "%", sep=""))
pie(table(All.10.Amb$Stage), main="10 DegC, Amp pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Amb$Stage), "\n", round(All.p$`10.Amb`), "%", sep=""))
title("Gonad Stage by Treatment, all Populations \nOstrea lurida 2016-2017 Experiment", outer=TRUE)
dev.off()
# Each Population Separately ----------------------------------------------
Pops <- levels(Histo$Population)
Pop.names <- c("Hood Canal", "South Sound F2", "Fidalgo Bay", "South Sound F1")
for (i in 1:length(Pops)) {
T <- Pops[i]
T.6 <- subset(Histo, Population %in% T & Phase %in% "TEMP" & Treatment %in% "6")
T.10 <- subset(Histo, Population %in% T & Phase %in% "TEMP" & Treatment %in% "10")
T.6.Low <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "6-Low")
T.6.Amb <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "6-Amb")
T.10.Low <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "10-Low")
T.10.Amb <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "10-Amb")
Tp.6 <- data.frame(unclass(100*prop.table(table(T.6$Stage))))
Tp.10 <- data.frame(unclass(100*prop.table(table(T.10$Stage))))
Tp.6.Low <- data.frame(unclass(100*prop.table(table(T.6.Low$Stage))))
Tp.6.Amb <- data.frame(unclass(100*prop.table(table(T.6.Amb$Stage))))
Tp.10.Low <- data.frame(unclass(100*prop.table(table(T.10.Low$Stage))))
Tp.10.Amb <- data.frame(unclass(100*prop.table(table(T.10.Amb$Stage))))
T.p <- data.frame(cbind(Tp.6, Tp.10, Tp.6.Low, Tp.6.Amb, Tp.10.Low, Tp.10.Amb))
colnames(T.p) <- c("6", "10", "6.Low", "6.Amb", "10.Low", "10.Amb")
Stages <- c("Stage 1", "Stage 2", "Stage 3")
filename <- paste("~/Documents/Roberts Lab/O.lurida_Stress/Analyses/Gonad-Stage-Pie-Charts-", T, ".png", sep="")
png(filename = filename, width = 600, height = 800)
par(mfrow = c(3, 2), mar=c(.5,1,3.5,.5), oma=c(1,2,3,1), cex.main= 1.3, cex=.75)
pie(table(T.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(T.6$Stage), "\n", round(T.p$`6`), "%", sep=""))
pie(table(T.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(T.10$Stage), ", ", round(T.p$`10`), "%", sep=""))
pie(table(T.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.6.Low$Stage), "\n", round(T.p$`6.Low`), "%", sep=""))
pie(table(T.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.10.Low$Stage), "\n", round(T.p$`10.Low`), "%", sep=""))
pie(table(T.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.6.Amb$Stage), "\n", round(T.p$`6.Amb`), "%", sep=""))
pie(table(T.10.Amb$Stage), main="10 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.10.Amb$Stage), "\n", round(T.p$`10.Amb`), "%", sep=""))
title(paste("Gonad Stage by Treatment ", Pop.names[i], "\n", "Ostrea lurida 2016-2017 Experiment", sep=""), outer=TRUE)
dev.off()
}
### boneyard
# Histo$Stage <- as.factor(Histo$Stage)
# counts.temp <- count(df=subset(Histo, Phase %in% "TEMP"), c("Phase", "Treatment", "Stage"))
# counts.OA <- count(df=subset(Histo, Phase %in% "OA"), c("Phase", "Treatment", "Stage"))
# counts.all <- count(df=Histo, c("Phase", "Treatment", "Stage"))
setwd("~/Documents/Roberts Lab/O.lurida_Stress/Data")
Histo <- read.csv("2017-Oly-Histo-Results.csv", header=T, stringsAsFactors = T)
Histo$Stage <- as.factor(Histo$Stage)
library(plyr)
# All Populations Combined ------------------------------------------------
All.6 <- subset(Histo, Phase %in% "TEMP" & Treatment %in% "6")
All.10 <- subset(Histo, Phase %in% "TEMP" & Treatment %in% "10")
All.6.Low <- subset(Histo, Phase %in% "OA" & Treatment %in% "6-Low")
All.6.Amb <- subset(Histo, Phase %in% "OA" & Treatment %in% "6-Amb")
All.10.Low <- subset(Histo, Phase %in% "OA" & Treatment %in% "10-Low")
All.10.Amb <- subset(Histo, Phase %in% "OA" & Treatment %in% "10-Amb")
Allp.6 <- data.frame(unclass(100*prop.table(table(All.6$Stage))))
Allp.10 <- data.frame(unclass(100*prop.table(table(All.10$Stage))))
Allp.6.Low <- data.frame(unclass(100*prop.table(table(All.6.Low$Stage))))
Allp.6.Amb <- data.frame(unclass(100*prop.table(table(All.6.Amb$Stage))))
Allp.10.Low <- data.frame(unclass(100*prop.table(table(All.10.Low$Stage))))
Allp.10.Amb <- data.frame(unclass(100*prop.table(table(All.10.Amb$Stage))))
All.p <- data.frame(cbind(Allp.6, Allp.10, Allp.6.Low, Allp.6.Amb, Allp.10.Low, Allp.10.Amb))
colnames(All.p) <- c("6", "10", "6.Low", "6.Amb", "10.Low", "10.Amb")
Stages <- c("Stage 1", "Stage 2", "Stage 3")
png(filename = "~/Documents/Roberts Lab/O.lurida_Stress/Analyses/Gonad-Stage-Pie-Charts.png", width = 600, height = 800)
par(mfrow = c(3, 2), mar=c(.5,1,3.5,.5), oma=c(1,2,3,1), cex.main= 1.3, cex=.75)
pie(table(All.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.6$Stage), "\n", round(All.p$`6`), "%", sep=""))
pie(table(All.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(All.10$Stage),"\n", round(All.p$`10`), "%", sep=""))
pie(table(All.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Low$Stage), "\n", round(All.p$`6.Low`), "%", sep=""))
pie(table(All.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Low$Stage),"\n", round(All.p$`10.Low`), "%", sep=""))
pie(table(All.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.6.Amb$Stage), "\n", round(All.p$`6.Amb`), "%", sep=""))
pie(table(All.10.Amb$Stage), main="10 DegC, Amp pH", radius=1, labels=paste(Stages, "\n", "n=", table(All.10.Amb$Stage), "\n", round(All.p$`10.Amb`), "%", sep=""))
title("Gonad Stage by Treatment, all Populations \nOstrea lurida 2016-2017 Experiment", outer=TRUE)
dev.off()
# Each Population Separately ----------------------------------------------
Pops <- levels(Histo$Population)
Pop.names <- c("Hood Canal", "South Sound F2", "Fidalgo Bay", "South Sound F1")
for (i in 1:length(Pops)) {
T <- Pops[i]
T.6 <- subset(Histo, Population %in% T & Phase %in% "TEMP" & Treatment %in% "6")
T.10 <- subset(Histo, Population %in% T & Phase %in% "TEMP" & Treatment %in% "10")
T.6.Low <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "6-Low")
T.6.Amb <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "6-Amb")
T.10.Low <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "10-Low")
T.10.Amb <- subset(Histo, Population %in% T & Phase %in% "OA" & Treatment %in% "10-Amb")
Tp.6 <- data.frame(unclass(100*prop.table(table(T.6$Stage))))
Tp.10 <- data.frame(unclass(100*prop.table(table(T.10$Stage))))
Tp.6.Low <- data.frame(unclass(100*prop.table(table(T.6.Low$Stage))))
Tp.6.Amb <- data.frame(unclass(100*prop.table(table(T.6.Amb$Stage))))
Tp.10.Low <- data.frame(unclass(100*prop.table(table(T.10.Low$Stage))))
Tp.10.Amb <- data.frame(unclass(100*prop.table(table(T.10.Amb$Stage))))
T.p <- data.frame(cbind(Tp.6, Tp.10, Tp.6.Low, Tp.6.Amb, Tp.10.Low, Tp.10.Amb))
colnames(T.p) <- c("6", "10", "6.Low", "6.Amb", "10.Low", "10.Amb")
Stages <- c("Stage 1", "Stage 2", "Stage 3")
filename <- paste("~/Documents/Roberts Lab/O.lurida_Stress/Analyses/Gonad-Stage-Pie-Charts-", T, ".png", sep="")
png(filename = filename, width = 600, height = 800)
par(mfrow = c(3, 2), mar=c(.5,1,3.5,.5), oma=c(1,2,3,1), cex.main= 1.3, cex=.75)
pie(table(T.6$Stage), main="6 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(T.6$Stage), "\n", round(T.p$`6`), "%", sep=""))
pie(table(T.10$Stage), main="10 DegC", radius=1, labels=paste(Stages, "\n", "n=", table(T.10$Stage), ", ", round(T.p$`10`), "%", sep=""))
pie(table(T.6.Low$Stage), main="6 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.6.Low$Stage), "\n", round(T.p$`6.Low`), "%", sep=""))
pie(table(T.10.Low$Stage), main="10 DegC, Low pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.10.Low$Stage), "\n", round(T.p$`10.Low`), "%", sep=""))
pie(table(T.6.Amb$Stage), main="6 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.6.Amb$Stage), "\n", round(T.p$`6.Amb`), "%", sep=""))
pie(table(T.10.Amb$Stage), main="10 DegC, Amb pH", radius=1, labels=paste(Stages, "\n", "n=", table(T.10.Amb$Stage), "\n", round(T.p$`10.Amb`), "%", sep=""))
title(paste("Gonad Stage by Treatment ", Pop.names[i], "\n", "Ostrea lurida 2016-2017 Experiment", sep=""), outer=TRUE)
dev.off()
}
### boneyard
# Histo$Stage <- as.factor(Histo$Stage)
# counts.temp <- count(df=subset(Histo, Phase %in% "TEMP"), c("Phase", "Treatment", "Stage"))
# counts.OA <- count(df=subset(Histo, Phase %in% "OA"), c("Phase", "Treatment", "Stage"))
# counts.all <- count(df=Histo, c("Phase", "Treatment", "Stage"))
Allp.6.Low
All.6.Low
